package com.reception;

import javax.jms.Connection;
import javax.jms.ConnectionFactory;
import javax.jms.JMSException;
import javax.jms.MessageProducer;
import javax.jms.Queue;
import javax.jms.Session;
import javax.jms.TextMessage;
import javax.naming.Context;
import javax.naming.InitialContext;
import javax.naming.NamingException;

public class CL_Queue_Sender {

	private static final String CONNECTION_FACTORY = "jms/Connection";
    private static final String CONNECTION_QUEUE = "jms/queue";
 
    /**
     * @param args
     */
    public CL_Queue_Sender(String[] message1) {
        ConnectionFactory connectionFactory = null;
        Connection connection = null;
        //Get the JNDI Context
        try {
            Context jndiContext = new InitialContext();
             
            //Create the Connection Factory
            connectionFactory = (ConnectionFactory) jndiContext.lookup(CL_Queue_Sender.CONNECTION_FACTORY);
            connection = connectionFactory.createConnection();
             
            //Create the session
            Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
             
            //Initialize Message Producer
            MessageProducer producer = null;
             
            //Call methods to send publish messages
            publishToQueue(producer, jndiContext, session, message1[0]);
             
            System.out.println("Messages Sent!!!");
        } catch (NamingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (JMSException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }finally{
            try {
                if(connection != null){
                    connection.close();
                }
            } catch (JMSException e) {
                e.printStackTrace();
            }
        }
    }
     
     
    private static void publishToQueue(MessageProducer producer, Context jndiContext, Session session, String message) throws NamingException, JMSException{
        //Create new Queue
        Queue queue = (Queue) jndiContext.lookup(CL_Queue_Sender.CONNECTION_QUEUE);
         
        //Create Message Produer
        producer = session.createProducer(queue);
         
        //Send TextMessage
        TextMessage textMessage = session.createTextMessage();
        textMessage.setText(message);
        producer.send(textMessage);
    }

	
}
